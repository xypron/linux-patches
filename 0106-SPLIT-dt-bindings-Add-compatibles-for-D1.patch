From 99157b336bbf846f244f88a3628d57aeaae584dc Mon Sep 17 00:00:00 2001
From: Samuel Holland <samuel@sholland.org>
Date: Sun, 13 Jun 2021 23:37:01 -0500
Subject: [PATCH 106/120] [SPLIT] dt-bindings: Add compatibles for D1

Signed-off-by: Samuel Holland <samuel@sholland.org>
---
 .../allwinner,sun6i-a31-hwspinlock.yaml       |  9 +++-
 .../bindings/i2c/marvell,mv64xxx-i2c.yaml     |  1 +
 .../nvmem/allwinner,sun4i-a10-sid.yaml        |  5 +-
 .../sound/allwinner,sun4i-a10-i2s.yaml        |  2 +
 .../sound/allwinner,sun4i-a10-spdif.yaml      | 47 +++++++++++++++----
 .../bindings/spi/allwinner,sun6i-a31-spi.yaml |  1 +
 .../allwinner,sun4i-a10-system-control.yaml   |  5 ++
 .../timer/allwinner,sun5i-a13-hstimer.yaml    | 13 ++++-
 .../usb/allwinner,sun4i-a10-musb.yaml         |  1 +
 9 files changed, 71 insertions(+), 13 deletions(-)

diff --git a/Documentation/devicetree/bindings/hwlock/allwinner,sun6i-a31-hwspinlock.yaml b/Documentation/devicetree/bindings/hwlock/allwinner,sun6i-a31-hwspinlock.yaml
index 10e5a53e447b..7b532d6ed951 100644
--- a/Documentation/devicetree/bindings/hwlock/allwinner,sun6i-a31-hwspinlock.yaml
+++ b/Documentation/devicetree/bindings/hwlock/allwinner,sun6i-a31-hwspinlock.yaml
@@ -15,7 +15,11 @@ description:
 
 properties:
   compatible:
-    const: allwinner,sun6i-a31-hwspinlock
+    oneOf:
+      - const: allwinner,sun6i-a31-hwspinlock
+      - items:
+          - const: allwinner,sun20i-d1-hwspinlock
+          - const: allwinner,sun6i-a31-hwspinlock
 
   reg:
     maxItems: 1
@@ -26,6 +30,9 @@ properties:
   resets:
     maxItems: 1
 
+  interrupts:
+    maxItems: 1
+
 required:
   - compatible
   - reg
diff --git a/Documentation/devicetree/bindings/i2c/marvell,mv64xxx-i2c.yaml b/Documentation/devicetree/bindings/i2c/marvell,mv64xxx-i2c.yaml
index f771c09aabfc..e37ddad03439 100644
--- a/Documentation/devicetree/bindings/i2c/marvell,mv64xxx-i2c.yaml
+++ b/Documentation/devicetree/bindings/i2c/marvell,mv64xxx-i2c.yaml
@@ -21,6 +21,7 @@ properties:
           - enum:
               - allwinner,sun8i-a23-i2c
               - allwinner,sun8i-a83t-i2c
+              - allwinner,sun20i-d1-i2c
               - allwinner,sun50i-a64-i2c
               - allwinner,sun50i-a100-i2c
               - allwinner,sun50i-h6-i2c
diff --git a/Documentation/devicetree/bindings/nvmem/allwinner,sun4i-a10-sid.yaml b/Documentation/devicetree/bindings/nvmem/allwinner,sun4i-a10-sid.yaml
index 6687ab720304..e20381812ad3 100644
--- a/Documentation/devicetree/bindings/nvmem/allwinner,sun4i-a10-sid.yaml
+++ b/Documentation/devicetree/bindings/nvmem/allwinner,sun4i-a10-sid.yaml
@@ -22,7 +22,10 @@ properties:
       - const: allwinner,sun8i-h3-sid
       - const: allwinner,sun50i-a64-sid
       - items:
-          - const: allwinner,sun50i-a100-sid
+          - enum:
+              - allwinner,sun20i-d1-sid
+              - allwinner,sun50i-a100-sid
+              - allwinner,sun50i-h5-sid
           - const: allwinner,sun50i-a64-sid
       - const: allwinner,sun50i-h5-sid
       - const: allwinner,sun50i-h6-sid
diff --git a/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-i2s.yaml b/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-i2s.yaml
index 39b66e9ce3e3..a9befbde9fa5 100644
--- a/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-i2s.yaml
+++ b/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-i2s.yaml
@@ -23,6 +23,7 @@ properties:
       - items:
           - const: allwinner,sun8i-v3-i2s
           - const: allwinner,sun8i-h3-i2s
+      - const: allwinner,sun20i-d1-i2s
       - const: allwinner,sun50i-a64-codec-i2s
       - items:
           - const: allwinner,sun50i-a64-i2s
@@ -62,6 +63,7 @@ allOf:
               - allwinner,sun6i-a31-i2s
               - allwinner,sun8i-a83t-i2s
               - allwinner,sun8i-h3-i2s
+              - allwinner,sun20i-d1-i2s
               - allwinner,sun50i-a64-codec-i2s
               - allwinner,sun50i-h6-i2s
 
diff --git a/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-spdif.yaml b/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-spdif.yaml
index 444a432912bb..1711cc14c74c 100644
--- a/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-spdif.yaml
+++ b/Documentation/devicetree/bindings/sound/allwinner,sun4i-a10-spdif.yaml
@@ -21,6 +21,7 @@ properties:
       - const: allwinner,sun4i-a10-spdif
       - const: allwinner,sun6i-a31-spdif
       - const: allwinner,sun8i-h3-spdif
+      - const: allwinner,sun20i-d1-spdif
       - const: allwinner,sun50i-h6-spdif
       - items:
           - const: allwinner,sun8i-a83t-spdif
@@ -35,25 +36,49 @@ properties:
   interrupts:
     maxItems: 1
 
-  clocks:
-    items:
-      - description: Bus Clock
-      - description: Module Clock
-
-  clock-names:
-    items:
-      - const: apb
-      - const: spdif
-
   # Even though it only applies to subschemas under the conditionals,
   # not listing them here will trigger a warning because of the
   # additionalsProperties set to false.
+  clocks: true
+  clock-names: true
   dmas: true
   dma-names: true
   resets:
     maxItems: 1
 
 allOf:
+  - if:
+      properties:
+        compatible:
+          contains:
+            enum:
+              - allwinner,sun20i-d1-spdif
+
+    then:
+        clocks:
+          items:
+            - description: Bus Clock
+            - description: Receive Clock
+            - description: Transmit Clock
+
+        clock-names:
+          items:
+            - const: apb
+            - const: rx
+            - const: tx
+
+    else:
+      properties:
+        clocks:
+          items:
+            - description: Bus Clock
+            - description: Module Clock
+
+        clock-names:
+          items:
+            - const: apb
+            - const: spdif
+
   - if:
       properties:
         compatible:
@@ -61,6 +86,8 @@ allOf:
             enum:
               - allwinner,sun6i-a31-spdif
               - allwinner,sun8i-h3-spdif
+              - allwinner,sun20i-d1-spdif
+              - allwinner,sun50i-h6-spdif
 
     then:
       required:
diff --git a/Documentation/devicetree/bindings/spi/allwinner,sun6i-a31-spi.yaml b/Documentation/devicetree/bindings/spi/allwinner,sun6i-a31-spi.yaml
index 908248260afa..cbfa6ce5864a 100644
--- a/Documentation/devicetree/bindings/spi/allwinner,sun6i-a31-spi.yaml
+++ b/Documentation/devicetree/bindings/spi/allwinner,sun6i-a31-spi.yaml
@@ -24,6 +24,7 @@ properties:
       - items:
           - enum:
               - allwinner,sun8i-r40-spi
+              - allwinner,sun20i-d1-spi
               - allwinner,sun50i-h6-spi
               - allwinner,sun50i-h616-spi
           - const: allwinner,sun8i-h3-spi
diff --git a/Documentation/devicetree/bindings/sram/allwinner,sun4i-a10-system-control.yaml b/Documentation/devicetree/bindings/sram/allwinner,sun4i-a10-system-control.yaml
index 1c426c211e36..54290131bed1 100644
--- a/Documentation/devicetree/bindings/sram/allwinner,sun4i-a10-system-control.yaml
+++ b/Documentation/devicetree/bindings/sram/allwinner,sun4i-a10-system-control.yaml
@@ -39,6 +39,7 @@ properties:
       - items:
           - const: allwinner,sun8i-r40-system-control
           - const: allwinner,sun4i-a10-system-control
+      - const: allwinner,sun20i-d1-system-control
       - const: allwinner,sun50i-a64-sram-controller
         deprecated: true
       - const: allwinner,sun50i-a64-system-control
@@ -74,6 +75,7 @@ patternProperties:
               - const: allwinner,sun4i-a10-sram-a3-a4
               - const: allwinner,sun4i-a10-sram-c1
               - const: allwinner,sun4i-a10-sram-d
+              - const: allwinner,sun20i-d1-dsp-sram
               - const: allwinner,sun50i-a64-sram-c
               - items:
                   - const: allwinner,sun5i-a13-sram-a3-a4
@@ -96,6 +98,9 @@ patternProperties:
               - items:
                   - const: allwinner,sun8i-r40-sram-c1
                   - const: allwinner,sun4i-a10-sram-c1
+              - items:
+                  - const: allwinner,sun20i-d1-sram-c1
+                  - const: allwinner,sun4i-a10-sram-c1
               - items:
                   - const: allwinner,sun50i-a64-sram-c1
                   - const: allwinner,sun4i-a10-sram-c1
diff --git a/Documentation/devicetree/bindings/timer/allwinner,sun5i-a13-hstimer.yaml b/Documentation/devicetree/bindings/timer/allwinner,sun5i-a13-hstimer.yaml
index 2ecac754e1cd..124c34e15256 100644
--- a/Documentation/devicetree/bindings/timer/allwinner,sun5i-a13-hstimer.yaml
+++ b/Documentation/devicetree/bindings/timer/allwinner,sun5i-a13-hstimer.yaml
@@ -18,6 +18,13 @@ properties:
       - items:
           - const: allwinner,sun6i-a31-hstimer
           - const: allwinner,sun7i-a20-hstimer
+      - const: allwinner,sun50i-h6-hstimer
+        description: one interrupt, different register layout
+      - items:
+          - enum:
+              - allwinner,sun20i-d1-hstimer
+              - allwinner,sun50i-h616-hstimer
+          - const: allwinner,sun50i-h6-hstimer
 
   reg:
     maxItems: 1
@@ -45,7 +52,11 @@ required:
 if:
   properties:
     compatible:
-      const: allwinner,sun5i-a13-hstimer
+      contains:
+        enum:
+          - allwinner,sun5i-a13-hstimer
+          - allwinner,sun20i-d1-hstimer
+          - allwinner,sun50i-h616-hstimer
 
 then:
   properties:
diff --git a/Documentation/devicetree/bindings/usb/allwinner,sun4i-a10-musb.yaml b/Documentation/devicetree/bindings/usb/allwinner,sun4i-a10-musb.yaml
index 933fa356d2ce..e5dbf4169bc9 100644
--- a/Documentation/devicetree/bindings/usb/allwinner,sun4i-a10-musb.yaml
+++ b/Documentation/devicetree/bindings/usb/allwinner,sun4i-a10-musb.yaml
@@ -20,6 +20,7 @@ properties:
       - items:
           - enum:
               - allwinner,sun8i-a83t-musb
+              - allwinner,sun20i-d1-musb
               - allwinner,sun50i-h6-musb
           - const: allwinner,sun8i-a33-musb
       - items:
-- 
2.32.0

